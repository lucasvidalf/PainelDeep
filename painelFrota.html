<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<title>Dashboard — Disponibilidade de Empilhadeiras</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800;900&display=swap" rel="stylesheet">
<style>
  :root{
    --bg:#e8fffb; --paper:#fff; --tile:#f7fbfa;
    --brand:#0b4c59; --brand-2:#3db7ac; --ink:#0b1f1e;
    --muted:#6a7a79; --line:#dbe7e5;
    --chip:#edf7f6; --chip-line:rgba(61,183,172,.25);
    --shadow:0 8px 24px rgba(0,0,0,.08);
    --br-lg:16px; --br-md:12px; --br-sm:10px;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; background:var(--bg); color:var(--ink);
    font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif;
    padding: clamp(14px, 2.4vw, 28px);
  }

  /* título */
  header{ margin:0 0 16px; display:flex; align-items:center; gap:12px }
  header h1{ margin:0; font-weight:900; color:var(--brand); font-size: clamp(22px,3.2vw,36px) }

  /* grid: 2 por linha (desktop), 1 no mobile */
  .grid{
    display:grid; gap:18px;
    grid-template-columns: repeat(12, 1fr);
    width:100%;
  }
  .col-6{ grid-column: span 6; }
  @media (max-width:960px){ .col-6{ grid-column: span 12; } }

  /* painel */
  .panel{
    background:var(--paper); border:1px solid #d9efec; border-radius:var(--br-lg);
    box-shadow:var(--shadow); overflow:visible; display:flex; flex-direction:column;
  }
  .panel::before{ content:""; display:block; height:14px; background:var(--brand-2) }

  /* header do painel */
  .ph{
    display:grid; grid-template-columns: auto 1fr auto; gap:12px;
    align-items:center; padding:14px 14px 8px;
  }
  .ph .title{ margin:0; font-weight:900; font-size: clamp(18px,2.2vw,22px) }
  .ph .status{ font-size:22px }
  .ph .stamp{
    justify-self:end; font-size:12px; font-weight:900; color:#064a44;
    background:#d8f2ee; padding:7px 12px; border-radius:999px;
    box-shadow:0 0 0 2px rgba(61,183,172,.22) inset; white-space:nowrap;
  }

  /* chips + legenda */
  .subhead{
    display:flex; gap:10px; align-items:center; flex-wrap:wrap;
    padding:0 14px 10px;
  }
  .chips{ display:flex; gap:10px; flex-wrap:wrap }
  .chip{
    display:inline-flex; align-items:center; gap:8px; white-space:nowrap;
    background:var(--chip); padding:7px 12px; border-radius:999px; font-weight:800; color:#063a36; font-size:13px;
    box-shadow:0 0 0 1px var(--chip-line) inset;
  }
  .chip .dot{ width:10px; height:10px; border-radius:50% }
  .dot-disp{ background:#22a06b } .dot-manu{ background:#9aa4a3 }

  .legend{ margin-left:auto; display:flex; gap:8px; align-items:center; font-weight:800; font-size:12px; color:#355; }
  .legend .lg{ display:inline-flex; gap:6px; align-items:center; padding:4px 8px; border-radius:999px; background:#eef6f5; }
  .lg .sw{ width:12px; height:12px; border-radius:3px; }
  .sw-prev{ background:#f6e4b4 }
  .sw-corr{ background:#f3c1bd }

  .section{ padding:0 14px 14px }

  /* pares lado a lado e MESMA ALTURA */
  .pair{
    display:grid; grid-template-columns: 1fr 1fr; gap:14px;
    margin:10px 0 14px; align-items:stretch;
  }
  @media (max-width:760px){ .pair{ grid-template-columns: 1fr; } }

  .card{
    background:var(--tile); border:1px solid var(--line); border-radius:14px;
    padding:12px; display:flex; flex-direction:column; height:100%;
  }
  .card h3{
    margin:0 0 8px; font-size:15px; font-weight:900; color:var(--brand);
    display:flex; align-items:center; gap:10px;
  }
  .cap-badge{
    font-weight:900; font-size:12px; color:#063a36;
    padding:6px 10px; border-radius:999px; background:#d8f2ee; box-shadow:0 0 0 1px rgba(61,183,172,.22) inset;
  }

  /* listas */
  .list{ list-style:none; margin:0; padding:0; }
  .li{
    display:grid; grid-template-columns: auto 1fr auto; gap:10px;
    align-items:center; padding:10px 0; border-top:1px dashed #d9e6e3;
  }
  .li:first-child{ border-top:0 }

  .placa{
    display:inline-block; white-space:nowrap; word-break:keep-all;
    font-weight:900; color:#0b5660; background:#d8f2ee; border-radius:10px;
    padding:6px 10px; letter-spacing:.3px; min-width:84px; text-align:center;
    box-shadow:0 0 0 2px rgba(61,183,172,.18) inset;
  }
  /* placa com status (somente na lista de manutenção) */
  .placa.prev{ background:#f6e4b4; color:#7a5c00; box-shadow:0 0 0 2px rgba(212,163,58,.35) inset; }
  .placa.corr{ background:#f3c1bd; color:#7b1d18; box-shadow:0 0 0 2px rgba(200,66,58,.30) inset; }

  .col-h{ font-weight:800; color:#344; font-size:12px; text-transform:uppercase; letter-spacing:.4px; }
  .eta{ font-size:12px; color:var(--muted); }

  /* tabelas top-5 lado a lado, MESMA ALTURA */
  .table{ width:100%; border-collapse:collapse; border:1px solid var(--line); border-radius:12px; overflow:hidden; }
  .table th{ text-align:left; padding:9px 12px; font-size:13px; background:#e9f4f1; border-bottom:1px solid var(--line) }
  .table td{ padding:9px 12px; border-top:1px solid #eef4f3; font-size:13px }
  .table .placa{ display:inline-block }
</style>
</head>
<body>
  <header>
    <h1>Dashboard — Disponibilidade de Empilhadeiras</h1>
  </header>

  <main id="grid" class="grid"></main>

<script>
/* ========= DADOS MOCK (substitua pelo GAS depois) ========= */
const DATA = {
  sites:[
    {
      nome:"Lençóis Paulista",
      updated:"2025-08-29T06:45:12Z",
      grupos:[
        { cap:"7t",
          disponiveis:["LPL-101","LPL-307","LPL-234"],
          manut:[
            {placa:"LPL-553",tipo:"preventiva",motivo:"Elétrica",etaISO:"2025-08-30T00:00:00Z"},
            {placa:"LPL-775",tipo:"corretiva",motivo:"Elétrica",etaISO:"2025-08-30T00:00:00Z"}
          ]
        }
        /* OBS: LPL não tem 16t */
      ],
      top:{
        corretivas:[{placa:"LPL-775",os:4},{placa:"LPL-553",os:1}],
        paradas:[{placa:"LPL-775",horas:117},{placa:"LPL-553",horas:43}]
      }
    },
    {
      nome:"Pederneiras",
      updated:"2025-08-29T07:05:00Z",
      grupos:[
        { cap:"7t",  disponiveis:["PDN-701","PDN-702"], manut:[] },
        { cap:"16t", disponiveis:[], manut:[{placa:"PDN-1602",tipo:"corretiva",motivo:"Transmissão",etaISO:"2025-08-30T18:00:00Z"}] }
      ],
      top:{ corretivas:[{placa:"PDN-1602",os:5}], paradas:[{placa:"PDN-1602",horas:92}] }
    },
    {
      nome:"Santos",
      updated:"2025-08-29T10:40:00Z",
      grupos:[
        {cap:"7t",disponiveis:["STS-701","STS-703"],manut:[{placa:"STS-702",tipo:"corretiva",motivo:"Freio",etaISO:"2025-08-29T22:00:00Z"}]},
        {cap:"8t (ELE)",disponiveis:["STS-801"],manut:[]}
      ],
      top:{corretivas:[{placa:"STS-702",os:2}],paradas:[{placa:"STS-702",horas:24}]}
    },
    {
      nome:"Itajaí",
      updated:"2025-08-29T08:15:00Z",
      grupos:[
        {cap:"2,5t",disponiveis:["ITJ-025-1","ITJ-025-2"],manut:[]},
        {cap:"4,5t",disponiveis:[],manut:[{placa:"ITJ-045-1",tipo:"corretiva",motivo:"Mastro",etaISO:"2025-08-31T16:00:00Z"}]}
      ],
      top:{corretivas:[{placa:"ITJ-045-1",os:3}],paradas:[{placa:"ITJ-045-1",horas:55}]}
    },
    {
      nome:"Itapoá",
      updated:"2025-08-29T09:05:00Z",
      grupos:[
        {cap:"2,5t",disponiveis:["ITP-025-1","ITP-025-2"],manut:[]},
        {cap:"45t",disponiveis:[],manut:[{placa:"ITP-450-1",tipo:"corretiva",motivo:"Sistema de vácuo",etaISO:"2025-08-30T20:00:00Z"}]}
      ],
      top:{corretivas:[{placa:"ITP-450-1",os:1}],paradas:[{placa:"ITP-450-1",horas:70}]}
    },
    {
      nome:"Rio de Janeiro",
      updated:"2025-08-29T07:20:00Z",
      grupos:[
        {cap:"3,5t",disponiveis:["RIO-035-1"],manut:[]},
        {cap:"7t",disponiveis:["RIO-070-1"],manut:[]}
      ],
      top:{corretivas:[],paradas:[]}
    }
  ]
};

/* ===== Helpers ===== */
function fmtDateShort(iso){
  const d=new Date(iso); if(isNaN(+d)) return "—";
  const dd=String(d.getDate()).padStart(2,"0");
  const mm=String(d.getMonth()+1).padStart(2,"0");
  return dd+"/"+mm;
}
function siteCounters(site){
  let disp=0,manut=0,corr=0;
  site.grupos.forEach(g=>{
    disp+=g.disponiveis.length;
    manut+=g.manut.length;
    corr +=g.manut.filter(m=>m.tipo==='corretiva').length;
  });
  return {disp,manut,corr};
}
function statusIcon({disp,manut,corr}){
  const total=disp+manut; if(total===0) return "⚪";
  const r=disp/total;
  if(disp===0 || r<0.40) return "‼️";
  if(r<0.70 || corr>0)   return "⚠️";
  return "✅";
}
const chip = (t,cls) => `<span class="chip"><span class="dot ${cls}"></span>${t}</span>`;

/* ===== Render ===== */
const grid = document.getElementById('grid');

function renderPanel(site){
  const counts = siteCounters(site);

  const header = `
    <div class="ph">
      <h2 class="title">${site.nome}</h2>
      <div class="status" title="Status">${statusIcon(counts)}</div>
      <div class="stamp">Atualizado em ${fmtDateShort(site.updated)}</div>
    </div>
    <div class="subhead">
      <div class="chips">
        ${chip(\`Disp.: \${counts.disp}\`,'dot-disp')}
        ${chip(\`Manut.: \${counts.manut}\`,'dot-manu')}
      </div>
      <div class="legend">
        <span class="lg"><span class="sw sw-corr"></span> Corretiva</span>
        <span class="lg"><span class="sw sw-prev"></span> Preventiva</span>
      </div>
    </div>
  `;

  const groups = site.grupos.map(g=>{
    const left = `
      <div class="card">
        <h3><span>Placas disponíveis</span> <span class="cap-badge">${g.cap}</span></h3>
        <ul class="list">
          ${ g.disponiveis.length
              ? g.disponiveis.map(p=>`
                  <li class="li"><span class="placa">${p}</span><span></span><span></span></li>
                `).join('')
              : `<li class="li"><span class="eta">— nenhuma placa disponível</span></li>` }
        </ul>
      </div>`;

    const rightHeader = `<li class="li col-h"><span></span><span>Motivo</span><span>Previsão</span></li>`;
    const right = `
      <div class="card">
        <h3><span>Em manutenção</span> <span class="cap-badge">${g.cap}</span></h3>
        <ul class="list">
          ${ g.manut.length
              ? [
                  rightHeader,
                  ...g.manut.map(m=>{
                    const cls = m.tipo==='corretiva' ? 'corr' : 'prev';
                    return `
                      <li class="li">
                        <span class="placa ${cls}">${m.placa}</span>
                        <span>${m.motivo||'—'}</span>
                        <span class="eta">${fmtDateShort(m.etaISO)}</span>
                      </li>`;
                  })
                ].join('')
              : `<li class="li"><span class="eta">— sem manutenção no momento</span></li>` }
        </ul>
      </div>`;

    return `<div class="pair">${left}${right}</div>`;
  }).join('');

  const tops = `
    <div class="pair">
      <div class="card">
        <h3>Top 5 — OS Corretivas <span class="cap-badge">(mês)</span></h3>
        <table class="table">
          <thead><tr><th>Placa</th><th>#OS</th></tr></thead>
          <tbody>
            ${ (site.top?.corretivas||[]).slice(0,5).map(r=>`
              <tr><td><span class="placa corr">${r.placa}</span></td><td>${r.os}</td></tr>
            `).join('') || `<tr><td class="eta">— sem dados</td><td></td></tr>`}
          </tbody>
        </table>
      </div>
      <div class="card">
        <h3>Top 5 — Tempo de Parada <span class="cap-badge">(mês)</span></h3>
        <table class="table">
          <thead><tr><th>Placa</th><th>Horas</th></tr></thead>
          <tbody>
            ${ (site.top?.paradas||[]).slice(0,5).map(r=>`
              <tr><td><span class="placa">${r.placa}</span></td><td>${r.horas}</td></tr>
            `).join('') || `<tr><td class="eta">— sem dados</td><td></td></tr>`}
          </tbody>
        </table>
      </div>
    </div>
  `;

  return `<section class="panel col-6">${header}<div class="section">${groups}${tops}</div></section>`;
}

function renderDashboard(data){
  grid.innerHTML = data.sites.map(renderPanel).join('');
}

/* boot */
renderDashboard(DATA);

/* Integração futura:
fetch(SCRIPT_URL).then(r=>r.json()).then(renderDashboard);
*/
</script>
</body>
</html>